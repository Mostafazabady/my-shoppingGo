"use strict";(self.webpackChunkShopping_go=self.webpackChunkShopping_go||[]).push([[736],{3736:(x,f,i)=>{i.r(f),i.d(f,{ProfileComponent:()=>w});var l=i(177),s=i(4341),a=i(9969),e=i(2598),p=i(3100),g=i(8256),m=i(1626);let u=(()=>{class o{constructor(t){this._HttpClient=t,this.basUrl="https://ecommerce.routemisr.com/api/v1/auth/"}forgetPassword(t){return this._HttpClient.post(this.basUrl+"forgotPasswords",t)}resetCode(t){return this._HttpClient.post(this.basUrl+"verifyResetCode",t)}newPassword(t){return this._HttpClient.put(this.basUrl+"resetPassword",t)}static{this.\u0275fac=function(n){return new(n||o)(e.KVO(m.Qq))}}static{this.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var h=i(3276);function v(o,c){1&o&&(e.j41(0,"span"),e.EFF(1,"Send Reset Code "),e.nrm(2,"i",30),e.k0s())}function b(o,c){1&o&&e.nrm(0,"i",31)}function C(o,c){if(1&o){const t=e.RV6();e.j41(0,"div",17)(1,"div",18)(2,"div",19),e.EFF(3,"Step 1 of 3"),e.k0s(),e.j41(4,"h3",20),e.nrm(5,"i",21),e.EFF(6," Forgot Password?"),e.k0s(),e.j41(7,"p",22),e.EFF(8,"Enter your email to receive a verification code."),e.k0s(),e.j41(9,"form",23),e.bIt("ngSubmit",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.forgetPassword())}),e.j41(10,"div",24),e.nrm(11,"input",25),e.j41(12,"label",26),e.EFF(13,"Email Address"),e.k0s()(),e.j41(14,"button",27),e.DNE(15,v,3,0,"span",28),e.DNE(16,b,1,0,"i",29),e.k0s()()()()}if(2&o){const t=e.XpG();e.Y8G("@fadeSlide",void 0),e.R7$(9),e.Y8G("formGroup",t.forgetForm),e.R7$(5),e.Y8G("disabled",t.isLoading),e.R7$(1),e.Y8G("ngIf",!t.isLoading),e.R7$(1),e.Y8G("ngIf",t.isLoading)}}function P(o,c){if(1&o){const t=e.RV6();e.j41(0,"div",17)(1,"div",18)(2,"div",19),e.EFF(3,"Step 2 of 3"),e.k0s(),e.j41(4,"h3",20),e.nrm(5,"i",32),e.EFF(6," Verify Code"),e.k0s(),e.j41(7,"p",22),e.EFF(8,"Enter the 6-digit code sent to "),e.j41(9,"b"),e.EFF(10),e.k0s()(),e.j41(11,"form",23),e.bIt("ngSubmit",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.resetCode())}),e.j41(12,"div",24),e.nrm(13,"input",33),e.j41(14,"label",34),e.EFF(15,"Reset Code"),e.k0s()(),e.j41(16,"button",35),e.EFF(17,"Verify Code "),e.nrm(18,"i",36),e.k0s()()()()}if(2&o){const t=e.XpG();e.Y8G("@fadeSlide",void 0),e.R7$(10),e.JRh(t.email),e.R7$(1),e.Y8G("formGroup",t.resetCodeForm)}}function _(o,c){if(1&o){const t=e.RV6();e.j41(0,"div",17)(1,"div",18)(2,"div",19),e.EFF(3,"Step 3 of 3"),e.k0s(),e.j41(4,"h3",20),e.nrm(5,"i",37),e.EFF(6," New Password"),e.k0s(),e.j41(7,"p",22),e.EFF(8,"Choose a strong password for your account."),e.k0s(),e.j41(9,"form",23),e.bIt("ngSubmit",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.newPassword())}),e.j41(10,"div",24),e.nrm(11,"input",38),e.j41(12,"label",39),e.EFF(13,"New Password"),e.k0s()(),e.j41(14,"button",35),e.EFF(15,"Update Password "),e.nrm(16,"i",40),e.k0s()()()()}if(2&o){const t=e.XpG();e.Y8G("@fadeSlide",void 0),e.R7$(9),e.Y8G("formGroup",t.resetPassword)}}const k=function(o){return{"dark-mode":o}};let w=(()=>{class o{constructor(t,n,r,d){this._AuthService=t,this._ToastrService=n,this._ForgetPasswordService=r,this._Router=d,this.userImage="./assets/images/avatar.webp",this.isDark=!1,this.step1=!0,this.step2=!1,this.step3=!1,this.email="",this.isLoading=!1,this.forgetForm=new s.gE({email:new s.MJ("",[s.k0.required,s.k0.email])}),this.resetCodeForm=new s.gE({resetCode:new s.MJ("",[s.k0.required])}),this.resetPassword=new s.gE({newPassword:new s.MJ("",[s.k0.required,s.k0.minLength(6)])})}ngOnInit(){this.isDark="dark"===localStorage.getItem("theme");const t=localStorage.getItem("userImage");t&&(this.userImage=t)}toggleDarkMode(){this.isDark=!this.isDark,localStorage.setItem("theme",this.isDark?"dark":"light")}onFileSelected(t){const n=t.target.files[0];if(n){const r=new FileReader;r.onload=d=>{this.userImage=d.target.result,localStorage.setItem("userImage",this.userImage),this._ToastrService.info("Profile picture updated locally! \u{1f4f8}")},r.readAsDataURL(n)}}forgetPassword(){this.forgetForm.valid&&(this.isLoading=!0,this._ForgetPasswordService.forgetPassword(this.forgetForm.value).subscribe({next:t=>{this._ToastrService.success(t.message||"Reset code sent to your email!"),this.email=this.forgetForm.value.email,this.step1=!1,setTimeout(()=>this.step2=!0,400),this.isLoading=!1},error:t=>{this._ToastrService.error(t.error.message),this.isLoading=!1}}))}resetCode(){this.resetCodeForm.valid&&this._ForgetPasswordService.resetCode(this.resetCodeForm.value).subscribe({next:t=>{this._ToastrService.success("Code Verified! Set your new password."),this.step2=!1,setTimeout(()=>this.step3=!0,400)},error:t=>this._ToastrService.error(t.error.message)})}newPassword(){if(this.resetPassword.valid){let t=this.resetPassword.value;t.email=this.email,this._ForgetPasswordService.newPassword(t).subscribe({next:n=>{n.token&&(localStorage.setItem("_token",n.token),this._ToastrService.success("Password updated! Redirecting..."),setTimeout(()=>this._Router.navigate(["/home"]),1500))},error:n=>this._ToastrService.error(n.error.message)})}}static{this.\u0275fac=function(n){return new(n||o)(e.rXU(p.u),e.rXU(g.tw),e.rXU(u),e.rXU(h.Ix))}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-profile"]],standalone:!0,features:[e.aNF],decls:22,vars:10,consts:[[1,"profile-container",3,"ngClass"],[1,"container","py-5"],[1,"row","g-4","justify-content-center"],[1,"col-lg-4"],[1,"profile-card","text-center","shadow-lg"],[1,"avatar-upload"],[1,"avatar-preview"],["id","imagePreview","alt","User","loading","lazy",3,"src"],[1,"avatar-edit"],["type","file","id","imageUpload","accept",".png, .jpg, .jpeg",3,"change"],["for","imageUpload"],[1,"fas","fa-camera"],[1,"mt-3","text-main"],[1,"quick-settings","mt-4"],[1,"btn-toggle",3,"click"],[1,"col-lg-7"],["class","settings-content shadow",4,"ngIf"],[1,"settings-content","shadow"],[1,"settings-section"],[1,"step-badge"],[1,"mb-4"],[1,"fas","fa-envelope-open-text","me-2"],[1,"text-muted"],[3,"formGroup","ngSubmit"],[1,"form-floating","mb-3"],["type","email","formControlName","email","id","emailInput","placeholder","name@example.com",1,"form-control"],["for","emailInput"],["type","submit",1,"btn-save",3,"disabled"],[4,"ngIf"],["class","fas fa-spinner fa-spin",4,"ngIf"],[1,"fas","fa-paper-plane","ms-1"],[1,"fas","fa-spinner","fa-spin"],[1,"fas","fa-key","me-2"],["type","text","formControlName","resetCode","id","codeInput","placeholder","Code",1,"form-control"],["for","codeInput"],["type","submit",1,"btn-save"],[1,"fas","fa-shield-check","ms-1"],[1,"fas","fa-lock","me-2"],["type","password","formControlName","newPassword","id","passInput","placeholder","Password",1,"form-control"],["for","passInput"],[1,"fas","fa-check-circle","ms-1"]],template:function(n,r){1&n&&(e.j41(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6),e.nrm(7,"img",7),e.k0s(),e.j41(8,"div",8)(9,"input",9),e.bIt("change",function(F){return r.onFileSelected(F)}),e.k0s(),e.j41(10,"label",10),e.nrm(11,"i",11),e.k0s()()(),e.j41(12,"h4",12),e.EFF(13,"User Profile"),e.k0s(),e.j41(14,"div",13)(15,"button",14),e.bIt("click",function(){return r.toggleDarkMode()}),e.nrm(16,"i"),e.EFF(17),e.k0s()()()(),e.j41(18,"div",15),e.DNE(19,C,17,5,"div",16),e.DNE(20,P,19,3,"div",16),e.DNE(21,_,17,2,"div",16),e.k0s()()()()),2&n&&(e.Y8G("ngClass",e.eq3(8,k,r.isDark)),e.R7$(7),e.Y8G("src",r.userImage,e.B4B),e.R7$(9),e.HbH(r.isDark?"fas fa-sun text-warning":"fas fa-moon"),e.R7$(1),e.SpI(" ",r.isDark?"Light Mode":"Dark Mode"," "),e.R7$(2),e.Y8G("ngIf",r.step1),e.R7$(1),e.Y8G("ngIf",r.step2),e.R7$(1),e.Y8G("ngIf",r.step3))},dependencies:[l.MD,l.YU,l.bT,s.X1,s.qT,s.me,s.BC,s.cb,s.j4,s.JD],styles:[".profile-container[_ngcontent-%COMP%]{min-height:100vh;background:#f8f9fa;transition:all .4s ease;padding-top:80px}.profile-container.dark-mode[_ngcontent-%COMP%]{background:#0f172a}.profile-container.dark-mode[_ngcontent-%COMP%]   .profile-card[_ngcontent-%COMP%], .profile-container.dark-mode[_ngcontent-%COMP%]   .settings-content[_ngcontent-%COMP%]{background:#1e293b;color:#fff;border:1px solid rgba(255,255,255,.05)}.profile-container.dark-mode[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background:#334155;border-color:#475569;color:#fff}.profile-container.dark-mode[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:focus{background:#1e293b}.profile-container.dark-mode[_ngcontent-%COMP%]   .text-muted[_ngcontent-%COMP%]{color:#94a3b8!important}.profile-card[_ngcontent-%COMP%], .settings-content[_ngcontent-%COMP%]{background:#ffffff;border-radius:24px;padding:40px;border:1px solid rgba(0,0,0,.02)}.avatar-upload[_ngcontent-%COMP%]{position:relative;max-width:160px;margin:0 auto}.avatar-upload[_ngcontent-%COMP%]   .avatar-preview[_ngcontent-%COMP%]{width:160px;height:160px;border-radius:50%;border:4px solid #F8D171;box-shadow:0 10px 25px #024d9433;overflow:hidden}.avatar-upload[_ngcontent-%COMP%]   .avatar-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.avatar-upload[_ngcontent-%COMP%]   .avatar-edit[_ngcontent-%COMP%]{position:absolute;right:8px;bottom:8px}.avatar-upload[_ngcontent-%COMP%]   .avatar-edit[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{width:40px;height:40px;background:#024D94;color:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;box-shadow:0 4px 10px #000}.avatar-upload[_ngcontent-%COMP%]   .avatar-edit[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover{transform:scale(1.1);background:#F8D171;color:#024d94}.avatar-upload[_ngcontent-%COMP%]   .avatar-edit[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{display:none}.step-badge[_ngcontent-%COMP%]{display:inline-block;background:rgba(248,209,113,.15);color:#f3b210;padding:5px 15px;border-radius:50px;font-size:.8rem;font-weight:700;margin-bottom:15px}.btn-save[_ngcontent-%COMP%]{width:100%;padding:14px;border-radius:12px;border:none;background:#024D94;color:#fff;font-weight:600;transition:.3s}.btn-save[_ngcontent-%COMP%]:hover:not(:disabled){background:#0367c6;box-shadow:0 8px 20px #024d944d}.btn-save[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.btn-toggle[_ngcontent-%COMP%]{width:100%;padding:10px;border-radius:50px;border:2px solid #F8D171;background:transparent;color:inherit;font-weight:600}.btn-toggle[_ngcontent-%COMP%]:hover{background:#F8D171;color:#024d94}"],data:{animation:[(0,a.hZ)("fadeSlide",[(0,a.kY)(":enter",[(0,a.i0)("500s ease-out",(0,a.iF)({opacity:1,transform:"translateY(0)"}))]),(0,a.kY)(":leave",[(0,a.i0)("300ms ease-in",(0,a.iF)({opacity:0,transform:"translateY(-20px)"}))])])]}})}}return o})()}}]);